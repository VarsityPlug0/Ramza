# Setting Up a New Service and Database on Render

## Prerequisites
1. You have a Render account
2. You have created a new PostgreSQL database on Render
3. You have this Django application code

## Step 1: Get Your Database Connection Details

1. Go to your Render dashboard
2. Find your newly created PostgreSQL database
3. Click on "Connect" tab
4. Copy the "External Database URL" - it should look like:
   ```
   postgresql://username:password@host:port/database_name
   ```

## Step 2: Update Configuration Files

### Update render.yaml
Replace the placeholder values in [render.yaml](file:///c%3A/Users/money/Bevan%20The%20IT%20GUY/absa/ramzas-chillas/render.yaml):

```yaml
services:
  - type: web
    name: your-service-name  # Choose a unique name for your service
    env: python
    buildCommand: "pip install -r requirements.txt"
    startCommand: "python start_server.py"
    envVars:
      - key: DATABASE_URL
        value: "postgresql://username:password@host:port/database_name"  # Your actual database URL
      - key: SECRET_KEY
        sync: false
      - key: WEB_CONCURRENCY
        value: 4
```

## Step 3: Deploy Your Service

1. Commit your changes:
   ```bash
   git add .
   git commit -m "Configure for new Render service"
   git push origin master
   ```

2. Go to Render dashboard
3. Click "New" â†’ "Web Service"
4. Connect your GitHub repository
5. Ensure the branch is set to master (or main)
6. Render should automatically detect and use your [render.yaml](file:///c%3A/Users/money/Bevan%20The%20IT%20GUY/absa/ramzas-chillas/render.yaml) configuration

## Step 4: Verify Deployment

1. After deployment completes, check the logs for successful migration:
   ```
   === START SERVER SCRIPT ===
   Setting up Django...
   Django setup completed successfully
   Running Django migrations...
   Migrations completed successfully
   Creating superuser if needed...
   Superuser created successfully
   Starting Gunicorn server...
   ```

2. Access your application using the URL provided by Render

## Step 5: Access Admin Panel

1. Go to `https://your-app-url.onrender.com/admin/`
2. Login with credentials:
   - Username: admin
   - Password: admin123

## Troubleshooting

### If migrations fail:
1. Check the database connection string in [render.yaml](file:///c%3A/Users/money/Bevan%20The%20IT%20GUY/absa/ramzas-chillas/render.yaml)
2. Verify the database is running and accessible
3. Check Render logs for specific error messages

### If application doesn't start:
1. Ensure all environment variables are correctly set
2. Check that the start command in [render.yaml](file:///c%3A/Users/money/Bevan%20The%20IT%20GUY/absa/ramzas-chillas/render.yaml) is correct
3. Verify dependencies in [requirements.txt](file:///c%3A/Users/money/Bevan%20The%20IT%20GUY/absa/ramzas-chillas/requirements.txt) are up to date

## Environment Variables

The following environment variables are used:

- `DATABASE_URL`: PostgreSQL connection string (provided by Render for Render databases)
- `SECRET_KEY`: Django secret key (auto-generated by Render)
- `WEB_CONCURRENCY`: Number of Gunicorn workers (set to 4)
- `PORT`: Port for the application (provided by Render)

## Database Migrations

The [start_server.py](file:///c%3A/Users/money/Bevan%20The%20IT%20GUY/absa/ramzas-chillas/start_server.py) script automatically runs migrations on every startup:

1. Sets up Django environment
2. Runs `python manage.py migrate --noinput`
3. Creates a superuser if one doesn't exist
4. Starts the Gunicorn server

This ensures your database schema is always up to date.